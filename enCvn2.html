<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EnCvn2</title>

    <script>


        const d = "sec;*; ;;d;c;h;c;h;c;h;".split(";");

        const e = [63,76,31,26,36,43,76,62,8,26,72,38,92,76,40,6,89,46,57,27,40,1,3,83,81,83,12,66,59,85,66,77,61,6,10,47,38,56,16,30,8,30,75,36,34,72,60,39,30,32,13,32,21,44,30,68,24,94,89,32,17,10,5,14,11,76,50,13,48,48,89,81,7,44,7,10,11,21,56,16,63,6,33,60,74,4,30,75,14,2,63,65,17,75,21,29,89,76,35,79,62,26,83,10,59,43,49,32,17,64,13,39,29,45,7,21,10,41,32,58,64,60,89,50,56,16,16,30,79,1,79,23,32,66,79,22,74,51,64,24,54,29,70,19,3,15,84,8,12,62,43,89,73,77,34,25,90,14,47,64,75,33,77,50,59,90,10,54,75,7,33,68,8,18,79,90,90,2,76,94,63,0,55,39,44,91,50,34,69,14,33,17,55,84,29,54,47,49,1,50,44,57,54,70,27,13,90,55,36,17,67,14,56,12,49,45,94,89,15,52,18,39,35,59,83,22,37,25,74,16,41,46,6,23,32,28,51,66,44,79,43,68,64,47,50,63,88,42,80,34,2,65,60,86,62,21,69,33,29,81,9,10,5,24,38,7,93,82,30,77,91,19,92,57,84,76,40,71,1,26,78,85,54,72,11,0,75,4,48,3,53,87,20,58,31,73,8,61,66,10,29,3,42,33,70,72,88,13,59,9,54,60,42,58,6,10,38,10,23,31,41,62,46,17,37,37,9,73,20,84,90,25,19,36,44,79,48,92,57,22,43,64,81,66,55,62,0,79,47,74,74,81,24,67,71,69,56,66,72,89,69,0,43,21,38,44,59,62,60,35,8,53,4,66,10,54,24,86,86,43,76,27,64,10,59,2,80,80,9,62,67,62,58,58,69,55,26,0,51,35,67,73,92,6,48,82,55,44,91,46,59,4,64,39,52,60,16,86,94,66,89,54,50,75,94,81,67,70,0,79,7,71,31,48,27,60,48,37,92,15,21,11,90,75,74,36,41,84,11,50,77,9,61,34,36,53,74,68,93,68,73,31,13,64,47,90,3,31,39,34,68,86,69,43,67,31,33,62,61,65,56,94,22,64,3,6,29,77,10,7,23,35,85,72,50,52,65,71,73,66,24,50,21,2,81,27,83,8,2,81,27,49,36,2,75,38,32,15,21,87,11,81,21,7,67,47,21,75,32,50,36,90,92,86,47,88,59,4,79,0,22,5,27,76,92,23,52,4,55,38,14,72,86,62,85,5,82,43,74,61,28,60,9,12,67,88,76,94,26,77,65,49,86,32,8,34,28,68,35,6,18,37,2,23,65,51,90,32,50,34,18,11,47,24,72,2,0,85,39,79,19,32,52,94,58,43,48,54,29,87,80,37,11,55,50,29,27,32,71,90,28,11,89,11,57,51,26,22,14,93,64,17,57,15,20,15,16,10,68,62,41,34,25,67,8,26,80,73,77,15,50,93,40,20,25,13,94,94,26,4,66,39,6,57,32,53,57,11,66,92,92,2,8,46,59,43,25,84,44,20,52,24,87,7,33,8,70,60,68,15,93,94,80,30,57,39,50,86,49,36,4,53,60,37,71,8,60,56,16,94,42,61,28,7,88,36];

        function a(b, e) {

            let a = r(b, gp(e));
            let result = d[3];
            // console.log(c)

            for (var i = 0; i < a.length; i++) {

                // console.log(a.charAt(i));
                let A = c(a.charAt(i));
                let B = c(d[4]) * c(d[5]) * c(d[6]);
                result += String.fromCharCode((( A - 32 + i * (i + B + i) * i) % 95 + 95) % 95 + 32);
            }

            return result;
        }


        /**
         * 获取字符的unicode码
         * @param b
         */
        function c(b) {
            return b.charCodeAt(0);
        }


        /**
         * 截取数组数据<br/>
         * @param b
         * @returns {Array}
         */
        function gp(b) {
            const start = c(d[7]) + c(d[8]);
            const end = c(d[9]) + c(d[10]) + 95;
            // 截取数组中的一部分
            b = b.slice(start, end);
            // console.warn(b);
            let e = [];
            for (var a = 0; a < b.length; a++) { // 根据下标互换数据
                // console.log(a, b[a]);
                e[b[a]] = a;
            }
            return e;
        }

        /**
         * 处理cvn2<br/>
         * @param b
         * @param e
         */
        function r(b, e) {
            let a = d[11];
            for (var i = 0; i < b.length; i++) {
                // 遍历 cvn2
                // console.log(b.charAt(i), c(b.charAt(i)) - 32, e[c(b.charAt(i)) - 32] + 32);
                // String.fromCharCode 可接受一个指定的 Unicode 值，然后返回一个字符串
                a += String.fromCharCode(e[c(b.charAt(i)) - 32] + 32);
            }
            return a;
        }


        (function () {
            const result = a('343', e)
            console.log("result:", result);
        })();

    </script>
</head>
<body>

</body>
</html>