<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EnCvn2</title>

    <script>


        const d = "sec;*; ;;d;c;h;c;h;c;h;".split(";");

        const e = [46,1,26,57,2,47,26,90,48,47,12,55,42,52,82,48,56,2,43,16,72,39,29,48,7,86,40,42,17,16,49,65,0,77,4,24,44,75,51,59,78,6,33,75,16,72,52,23,89,22,62,36,3,94,20,13,61,12,5,88,59,24,39,49,83,51,56,45,65,55,2,40,39,81,3,74,13,71,51,40,23,83,57,83,78,14,52,83,64,75,57,81,66,63,91,36,79,82,76,33,74,36,8,74,2,79,14,89,28,55,17,92,58,3,28,51,76,5,1,90,71,24,77,17,58,56,42,54,82,63,50,15,17,12,5,7,41,24,58,43,71,92,88,63,43,7,92,4,72,64,39,37,51,26,10,9,89,22,94,16,45,76,31,48,34,53,25,19,63,13,83,41,26,70,94,51,94,71,13,78,10,30,57,15,34,9,80,54,22,75,93,18,64,83,92,61,37,23,92,45,2,7,62,16,10,61,53,57,8,88,1,74,14,78,37,67,68,44,39,41,64,59,72,66,34,0,90,27,26,17,32,42,65,71,48,20,91,13,58,22,40,69,77,85,5,29,94,36,51,7,23,19,70,12,63,75,81,49,62,80,52,89,28,55,73,79,38,31,50,30,15,82,60,47,54,24,11,45,92,93,21,83,25,86,33,87,6,35,43,46,4,56,84,18,2,76,3,9,33,53,62,25,31,76,23,8,70,70,75,63,72,40,43,26,71,45,60,8,70,53,94,55,49,78,1,54,45,33,34,9,80,81,90,44,56,21,62,46,10,36,40,54,89,11,80,17,78,10,41,85,62,80,29,84,66,52,28,43,84,22,26,61,57,30,11,83,21,86,25,45,70,36,85,50,2,94,78,24,13,9,79,17,94,63,52,66,30,15,66,17,59,46,76,89,71,66,22,28,32,3,56,94,31,76,29,41,25,58,8,7,18,56,25,65,94,75,44,23,65,74,55,35,86,50,66,54,25,57,77,43,72,74,73,39,52,83,35,52,73,26,87,79,92,39,74,80,10,72,19,61,15,3,89,77,40,5,51,87,74,42,22,72,77,56,88,46,93,10,27,42,41,53,37,63,52,29,45,67,33,44,58,55,32,11,91,42,38,50,54,59,60,63,25,34,56,51,14,56,28,42,73,24,67,73,92,83,81,15,78,66,52,69,34,62,76,88,34,27,18,14,24,37,17,56,59,72,85,45,0,27,42,11,41,5,6,94,64,37,13,46,52,8,27,35,18,35,10,61,6,66,44,44,57,33,26,0,50,47,14,23,77,23,28,74,76,59,34,30,85,54,54,39,29,93,49,28,67,50,20,91,61,94,70,36,49,70,19,87,3,60,30,94,50,39,85,1,8,26,3,71,47,2,9,71,4,71,80,68,56,25,34,6,35,76,79,23,61,91,62,2,63,5,74,14,44,35,40,23,8,22,16,72,71,59,83,33,28,40,49,92,36,60,14,30,72,72,58,80,20,33,20,73,71,70,1,62,44,44,88,25,73,65,21,15,67,74,93,92,84,49,16,0,12,74,29,28,90,81,47,58,47,91,73,87,85,84,54,90,79,46,30,70,61,4,70,21,92,80,23,90,65,45,27,62,30,57,42,77,26,0,39,91,27,26,61,31];

        function a(b, e) {

            let a = r(b, gp(e));
            let result = d[3];
            // console.log(c)

            for (var i = 0; i < a.length; i++) {

                // console.log(a.charAt(i));
                let A = c(a.charAt(i));
                let B = c(d[4]) * c(d[5]) * c(d[6]);
                result += String.fromCharCode((( A - 32 + i * (i + B + i) * i) % 95 + 95) % 95 + 32);
            }

            return result;
        }


        /**
         * 获取字符的unicode码
         * @param b
         */
        function c(b) {
            const r = b.charCodeAt(0);
            return r;
        }


        /**
         * 截取数组数据<br/>
         * @param b
         * @returns {Array}
         */
        function gp(b) {
            const start = c(d[7]) + c(d[8]);
            const end = c(d[9]) + c(d[10]) + 95;
            // 截取数组中的一部分
            b = b.slice(start, end);
            // console.warn(b);
            let e = [];
            for (var a = 0; a < b.length; a++) { // 根据下标互换数据
                // console.log(a, b[a]);
                e[b[a]] = a;
            }
            return e;
        }

        /**
         * 处理cvn2<br/>
         * @param b
         * @param e
         */
        function r(b, e) {
            console.log(d.length)
            let a = d[11];
            for (var i = 0; i < b.length; i++) {
                // 遍历 cvn2
                console.log(b.charAt(i), c(b.charAt(i)) - 32, e[c(b.charAt(i)) - 32]);
                // String.fromCharCode 可接受一个指定的 Unicode 值，然后返回一个字符串
                a += String.fromCharCode(e[c(b.charAt(i)) - 32] + 32);
            }
            return a;
        }


        (function () {
            const result = a('965', e)
            console.log("result:", result);
        })();

    </script>
</head>
<body>

</body>
</html>